<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Trigonometria</title>
<style>
body { background: #0b0f1a; color: #fff; font-family: Arial, sans-serif; text-align: center; padding: 20px; }
h1 { color: #ffcc33; margin-bottom: 20px; }
input, select { width: 80%; max-width: 300px; padding: 10px; font-size: 16px; border: none; border-radius: 8px; outline: none; margin-bottom: 15px; }
button { background: #ffcc33; color: #000; border: none; padding: 10px 20px; font-size: 16px; border-radius: 8px; cursor: pointer; transition: 0.3s; margin-top: 10px; }
button:hover { background: #e6b800; }
#resultado, #explicacao { margin-top: 20px; font-size: 18px; text-align:left; display:inline-block; max-width:400px; }
canvas { margin-top: 30px; background: #fff; border-radius: 10px; }
.footer { margin-top: 20px; font-size: 0.8em; color: #94a3b8; }
</style>
</head>
<body>

<h1>Calculadora de Trigonometria</h1>

<input id="angulo" type="number" placeholder="Digite o ângulo" />
<br>
<select id="unidade">
  <option value="graus">Graus (°)</option>
  <option value="radianos">Radianos (rad)</option>
</select>
<br>
<select id="funcaoTrig">
  <option value="sin">Seno (sin)</option>
  <option value="cos">Cosseno (cos)</option>
  <option value="tan">Tangente (tan)</option>
</select>
<br>
<button onclick="calcularTrig()">Calcular e Mostrar Gráfico</button>
<button onclick="exportarPDF()">Exportar para PDF</button>

<div id="resultado"></div>
<canvas id="grafico" width="400" height="300"></canvas>
<div id="explicacao"></div>
<div class="footer">Desenvolvido por Bernard</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
let ultimoResultado = {};

function calcularTrig(){
  const angulo = parseFloat(document.getElementById("angulo").value);
  const unidade = document.getElementById("unidade").value;
  const funcao = document.getElementById("funcaoTrig").value;

  if(isNaN(angulo)){ alert("Digite um valor válido para o ângulo."); return; }

  let rad = unidade === 'graus' ? angulo * Math.PI/180 : angulo;
  let valor=0;

  if(funcao==='sin') valor = Math.sin(rad);
  else if(funcao==='cos') valor = Math.cos(rad);
  else if(funcao==='tan') valor = Math.tan(rad);

  const resultadoTexto = `${funcao}(${angulo} ${unidade==='graus'?'°':'rad'}) = ${valor.toFixed(4)}`;
  
  const explicacaoTexto = `Passo a passo:\n1. Conversão para radianos: ${unidade==='graus'? `${angulo}° × π/180 = ${rad.toFixed(4)} rad` : `${rad.toFixed(4)} rad`}\n2. Cálculo da função ${funcao}: ${valor.toFixed(4)}`;

  document.getElementById("resultado").innerHTML = resultadoTexto;
  document.getElementById("explicacao").innerHTML = `<pre>${explicacaoTexto}</pre>`;
  ultimoResultado = { angulo, unidade, funcao, resultadoTexto, explicacaoTexto };

  desenharGraficoTrig(funcao);
}

function desenharGraficoTrig(funcao){
  const canvas = document.getElementById("grafico");
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const escalaX=40, escalaY=40;
  const offsetX = canvas.width/2, offsetY = canvas.height/2;

  // eixos
  ctx.strokeStyle="#aaa";
  ctx.beginPath();
  ctx.moveTo(0,offsetY); ctx.lineTo(canvas.width,offsetY);
  ctx.moveTo(offsetX,0); ctx.lineTo(offsetX,canvas.height);
  ctx.stroke();

  // curva
  ctx.strokeStyle="#ffcc33";
  ctx.beginPath();
  for(let px=0; px<=canvas.width; px++){
    const x = (px-offsetX)/escalaX;
    let y=0;
    if(funcao==='sin') y = Math.sin(x);
    else if(funcao==='cos') y = Math.cos(x);
    else if(funcao==='tan') y = Math.tan(x);
    const py = offsetY - y*escalaY;
    if(px===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
  }
  ctx.stroke();
}

async function exportarPDF(){
  if(!ultimoResultado.resultadoTexto){ alert("Primeiro calcule!"); return; }
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(14); doc.text("Função Trigonométrica:",10,20);
  doc.setFontSize(12); doc.text(`${ultimoResultado.funcao}(${ultimoResultado.angulo} ${ultimoResultado.unidade==='graus'?'°':'rad'})`,10,30);
  doc.setFontSize(14); doc.text("Resultado:",10,45);
  doc.setFontSize(12); doc.text(ultimoResultado.resultadoTexto,10,55);
  doc.setFontSize(14); doc.text("Explicação:",10,70);
  doc.setFontSize(12); doc.text(ultimoResultado.explicacaoTexto,10,80,{maxWidth:190});
  const canvas = document.getElementById("grafico");
  const imgData = canvas.toDataURL("image/png");
  doc.addPage();
  doc.setFontSize(14); doc.text("Gráfico:",10,20);
  doc.addImage(imgData,'PNG',10,30,180,120);
  doc.save("Trigonometria.pdf");
}
</script>
</body>
</html>
